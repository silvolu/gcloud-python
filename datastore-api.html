
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Cloud Datastore &mdash; gcloud 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="gcloud 0.1 documentation" href="index.html" />
    <link rel="next" title="Getting started with Cloud Datastore" href="datastore-getting-started.html" />
    <link rel="prev" title="Cloud Common" href="common-api.html" /> 
  </head>
  <body role="document" class="two-column docs"><a href="https://github.com/GoogleCloudPlatform/gcloud-python"><img style="position: absolute; top: 0; right: 0; border: 0; z-index: 999;" src="_static/forkme.png" alt="Fork me on GitHub"></a>
    <div id="sandbar">
      <header id="gc-googlebar">
      <a id="gc-logo" href="index.html">
        <img src="_static/cloudplatform-horizontal.png" alt="Google">
        </a>
        <form class="gc-search" action="search.html" method="GET">
          <div class="searchbox" style="width: 429px;">
            <span class="button button-blue mini">Google Cloud Python API</span>
            <input type="hidden" name="check_keywords" value="yes">
            <input type="hidden" name="area" value="default">
            <input type="text" name="q" class="q" id="q" value=""
              placeholder="Search" autocomplete="off" style="width: 263px;">
          </div>
          <button class="button button-blue" style="top: 0px; left: 444px;">
          <img src="_static/search.png" alt="Search">
        </button>

        <input type="hidden" name="p" id="search_project" value="/compute">

      </form>
      </header>
    </div>
    
<div id="gc-wrapper">
  <div id="gc-appbar">
    <h1><a href="index.html">gcloud 0.1 documentation</a></h1>
  </div>
    <div id="gc-main" class="main">
      <div id="gc-sidebar" class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<nav class="gc-toc">
  <ul><li><a href="index.html">gCloud Documentation</a></li></ul>
  <ul>
<li><a class="reference internal" href="#">Cloud Datastore</a><ul>
<li><a class="reference internal" href="#module-gcloud.datastore.__init__"><code class="docutils literal"><span class="pre">gcloud.datastore</span></code></a></li>
<li><a class="reference internal" href="#module-gcloud.datastore.connection">Connections</a></li>
<li><a class="reference internal" href="#module-gcloud.datastore.dataset">Datasets</a></li>
<li><a class="reference internal" href="#module-gcloud.datastore.entity">Entities</a></li>
<li><a class="reference internal" href="#module-gcloud.datastore.key">Keys</a></li>
<li><a class="reference internal" href="#module-gcloud.datastore.query">Queries</a></li>
<li><a class="reference internal" href="#module-gcloud.datastore.transaction">Transactions</a></li>
</ul>
</li>
</ul>

  </nav>

            <h3>All API Docs</h3>
            <nav class="gc-toc">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common-api.html">Cloud Common</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Cloud Datastore</a></li>
<li class="toctree-l1"><a class="reference internal" href="datastore-getting-started.html">Getting started with Cloud Datastore</a></li>
<li class="toctree-l1"><a class="reference internal" href="datastore-quickstart.html">Cloud Datastore in 10 seconds</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started with gcloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage-api.html">Cloud Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage-getting-started.html">Getting started with Cloud Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage-quickstart.html">Cloud Storage in 10 seconds</a></li>
</ul>

            </nav>
            
            
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main" id="gc-content">
            
  <div class="section" id="cloud-datastore">
<h1>Cloud Datastore<a class="headerlink" href="#cloud-datastore" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-gcloud.datastore.__init__">
<span id="gcloud-datastore"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">gcloud.datastore</span></code><a class="headerlink" href="#module-gcloud.datastore.__init__" title="Permalink to this headline">¶</a></h2>
<p>Shortcut methods for getting set up with Google Cloud Datastore.</p>
<p>You&#8217;ll typically use these to get started with the API:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id-here&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="s">&#39;long-email@googleapis.com&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="s">&#39;/path/to/private.key&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Then do other things...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">()</span><span class="o">.</span><span class="n">kind</span><span class="p">(</span><span class="s">&#39;EntityKind&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entity</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;EntityKind&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The main concepts with this API are:</p>
<ul class="simple">
<li><a class="reference internal" href="#gcloud.datastore.connection.Connection" title="gcloud.datastore.connection.Connection"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.connection.Connection</span></code></a>
which represents a connection between your machine and the Cloud Datastore
API.</li>
<li><a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>
which represents a particular dataset
(akin to a database name in relational database world).</li>
<li><a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.entity.Entity</span></code></a>
which represents a single entity in the datastore
(akin to a row in relational database world).</li>
<li><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a>
which represents a pointer to a particular entity in the datastore
(akin to a unique identifier in relational database world).</li>
<li><a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.query.Query</span></code></a>
which represents a lookup or search over the rows in the datastore.</li>
</ul>
<dl class="data">
<dt id="gcloud.datastore.__init__.SCOPE">
<code class="descclassname">gcloud.datastore.__init__.</code><code class="descname">SCOPE</code><em class="property"> = ('https://www.googleapis.com/auth/datastore ', 'https://www.googleapis.com/auth/userinfo.email')</em><a class="headerlink" href="#gcloud.datastore.__init__.SCOPE" title="Permalink to this definition">¶</a></dt>
<dd><p>The scope required for authenticating as a Cloud Datastore consumer.</p>
</dd></dl>

<dl class="function">
<dt id="gcloud.datastore.__init__.get_connection">
<code class="descclassname">gcloud.datastore.__init__.</code><code class="descname">get_connection</code><span class="sig-paren">(</span><em>client_email</em>, <em>private_key_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/__init__.html#get_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.__init__.get_connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut method to establish a connection to the Cloud Datastore.</p>
<p>Use this if you are going to access several datasets
with the same set of credentials (unlikely):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_connection</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset1</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="s">&#39;dataset1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset2</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="s">&#39;dataset2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>client_email</strong> (<em>string</em>) &#8211; The e-mail attached to the service account.</li>
<li><strong>private_key_path</strong> (<em>string</em>) &#8211; The path to a private key file (this file was
given to you when you created the service
account).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#gcloud.datastore.connection.Connection" title="gcloud.datastore.connection.Connection"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.connection.Connection</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A connection defined with the proper credentials.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gcloud.datastore.__init__.get_dataset">
<code class="descclassname">gcloud.datastore.__init__.</code><code class="descname">get_dataset</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>client_email</em>, <em>private_key_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/__init__.html#get_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.__init__.get_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Establish a connection to a particular dataset in the Cloud Datastore.</p>
<p>This is a shortcut method for creating a connection and using it
to connect to a dataset.</p>
<p>You&#8217;ll generally use this as the first call to working with the API:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Now you can do things with the dataset.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">()</span><span class="o">.</span><span class="n">kind</span><span class="p">(</span><span class="s">&#39;TestKind&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="go">[...]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataset_id</strong> (<em>string</em>) &#8211; The id of the dataset you want to use.
This is akin to a database name
and is usually the same as your Cloud Datastore project
name.</li>
<li><strong>client_email</strong> (<em>string</em>) &#8211; The e-mail attached to the service account.</li>
<li><strong>private_key_path</strong> (<em>string</em>) &#8211; The path to a private key file (this file was
given to you when you created the service
account).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A dataset with a connection using the provided credentials.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gcloud.datastore.connection">
<span id="connections"></span><h2>Connections<a class="headerlink" href="#module-gcloud.datastore.connection" title="Permalink to this headline">¶</a></h2>
<p>Connections to gcloud datastore API servers.</p>
<dl class="class">
<dt id="gcloud.datastore.connection.Connection">
<em class="property">class </em><code class="descclassname">gcloud.datastore.connection.</code><code class="descname">Connection</code><span class="sig-paren">(</span><em>credentials=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="common-api.html#gcloud.connection.Connection" title="gcloud.connection.Connection"><code class="xref py py-class docutils literal"><span class="pre">gcloud.connection.Connection</span></code></a></p>
<p>A connection to the Google Cloud Datastore via the Protobuf API.</p>
<p>This class should understand only the basic types (and protobufs)
in method arguments, however should be capable of returning advanced types.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>credentials</strong> (<code class="xref py py-class docutils literal"><span class="pre">oauth2client.client.OAuth2Credentials</span></code>) &#8211; The OAuth2 Credentials to use for this connection.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="gcloud.datastore.connection.Connection.API_URL_TEMPLATE">
<code class="descname">API_URL_TEMPLATE</code><em class="property"> = '{api_base}/datastore/{api_version}/datasets/{dataset_id}/{method}'</em><a class="headerlink" href="#gcloud.datastore.connection.Connection.API_URL_TEMPLATE" title="Permalink to this definition">¶</a></dt>
<dd><p>A template for the URL of a particular API call.</p>
</dd></dl>

<dl class="attribute">
<dt id="gcloud.datastore.connection.Connection.API_VERSION">
<code class="descname">API_VERSION</code><em class="property"> = 'v1beta2'</em><a class="headerlink" href="#gcloud.datastore.connection.Connection.API_VERSION" title="Permalink to this definition">¶</a></dt>
<dd><p>The version of the API, used in building the API call&#8217;s URL.</p>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.begin_transaction">
<code class="descname">begin_transaction</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>serializable=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.begin_transaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.begin_transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Begin a transaction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dataset_id</strong> (<em>string</em>) &#8211; The dataset over which to execute the transaction.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="gcloud.datastore.connection.Connection.build_api_url">
<em class="property">classmethod </em><code class="descname">build_api_url</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>method</em>, <em>base_url=None</em>, <em>api_version=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.build_api_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.build_api_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the URL for a particular API call.</p>
<p>This method is used internally
to come up with the URL
to use when making RPCs
to the Cloud Datastore API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset_id</strong> (<em>string</em>) &#8211; The ID of the dataset to connect to. This is
usually your project name in the cloud console.</li>
<li><strong>method</strong> (<em>string</em>) &#8211; The API method to call (ie, runQuery, lookup, ...).</li>
<li><strong>base_url</strong> (<em>string</em>) &#8211; The base URL where the API lives.
You shouldn&#8217;t have to provide this.</li>
<li><strong>api_version</strong> (<em>string</em>) &#8211; The version of the API to connect to.
You shouldn&#8217;t have to provide this.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.commit">
<code class="descname">commit</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>mutation_pb</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.commit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Commit dataset mutations in context of current transation (if any).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataset_id</strong> (<em>string</em>) &#8211; The dataset in which to perform the changes.</li>
<li><strong>mutation_pb</strong> (<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Mutation</span></code>.) &#8211; The protobuf for the mutations being saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.MutationResult</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns&#8217;:</th><td class="field-body"><p class="first last">the result protobuf for the mutation.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.dataset">
<code class="descname">dataset</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method for Dataset objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> &#8211; All args and kwargs will be passed along to the
<a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a> initializer.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A dataset object that will use this connection as
its transport.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.delete_entities">
<code class="descname">delete_entities</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>key_pbs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.delete_entities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.delete_entities" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete keys from a dataset in the Cloud Datastore.</p>
<p>This method deals only with
<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Key</span></code> protobufs
and not with any of the other abstractions.
For example, it&#8217;s used under the hood in the
<a class="reference internal" href="#gcloud.datastore.entity.Entity.delete" title="gcloud.datastore.entity.Entity.delete"><code class="xref py py-func docutils literal"><span class="pre">gcloud.datastore.entity.Entity.delete()</span></code></a> method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataset_id</strong> (<em>string</em>) &#8211; The dataset from which to delete the keys.</li>
<li><strong>key_pbs</strong> (list of <code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Key</span></code>) &#8211; The keys to delete from the datastore.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">boolean (if in a transaction) or else
<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.MutationResult</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True (if in a transaction) or else a mutation result protobuf.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.delete_entity">
<code class="descname">delete_entity</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>key_pb</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.delete_entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.delete_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a single key from a dataset in the Cloud Datastore.</p>
<p>This method deals only with
<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Key</span></code> protobufs
and not with any of the other abstractions.
For example, it&#8217;s used under the hood in the
<a class="reference internal" href="#gcloud.datastore.entity.Entity.delete" title="gcloud.datastore.entity.Entity.delete"><code class="xref py py-func docutils literal"><span class="pre">gcloud.datastore.entity.Entity.delete()</span></code></a> method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataset_id</strong> (<em>string</em>) &#8211; The dataset from which to delete the key.</li>
<li><strong>key_pb</strong> (<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Key</span></code>) &#8211; The key to delete from the datastore.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">boolean (if in a transaction) or else
<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.MutationResult</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True (if in a transaction) or else a mutation result protobuf.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.lookup">
<code class="descname">lookup</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>key_pbs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.lookup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Lookup keys from a dataset in the Cloud Datastore.</p>
<p>This method deals only with protobufs
(<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Key</span></code>
and
<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Entity</span></code>)
and is used under the hood for methods like
<a class="reference internal" href="#gcloud.datastore.dataset.Dataset.get_entity" title="gcloud.datastore.dataset.Dataset.get_entity"><code class="xref py py-func docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset.get_entity()</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud.datastore.key</span> <span class="kn">import</span> <span class="n">Key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_connection</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">Key</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span><span class="o">.</span><span class="n">kind</span><span class="p">(</span><span class="s">&#39;MyKind&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the <a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a> helper:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">&lt;Entity object&gt;</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal"><span class="pre">connection</span></code> class directly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">to_protobuf</span><span class="p">())</span>
<span class="go">&lt;Entity protobuf&gt;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataset_id</strong> (<em>string</em>) &#8211; The dataset to look up the keys.</li>
<li><strong>key_pbs</strong> (list of <code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Key</span></code>
(or a single Key)) &#8211; The key (or keys) to retrieve from the datastore.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list of <code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Entity</span></code>
(or a single Entity)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The entities corresponding to the keys provided.
If a single key was provided and no results matched,
this will return None.
If multiple keys were provided and no results matched,
this will return an empty list.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.mutation">
<code class="descname">mutation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.mutation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.mutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter for mutation usable with current connection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Mutation</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the mutation instance associated with the current transaction
(if one exists) or or a new mutation instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.rollback_transaction">
<code class="descname">rollback_transaction</code><span class="sig-paren">(</span><em>dataset_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.rollback_transaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.rollback_transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Rollback the connection&#8217;s existing transaction.</p>
<p>Raises a <code class="docutils literal"><span class="pre">ValueError</span></code>
if the connection isn&#8217;t currently in a transaction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dataset_id</strong> (<em>string</em>) &#8211; The dataset to which the transaction belongs.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.run_query">
<code class="descname">run_query</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>query_pb</em>, <em>namespace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.run_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.run_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a query on the Cloud Datastore.</p>
<p>Given a Query protobuf,
sends a <code class="docutils literal"><span class="pre">runQuery</span></code> request to the Cloud Datastore API
and returns a list of entity protobufs matching the query.</p>
<p>You typically wouldn&#8217;t use this method directly,
in favor of the <a class="reference internal" href="#gcloud.datastore.query.Query.fetch" title="gcloud.datastore.query.Query.fetch"><code class="xref py py-func docutils literal"><span class="pre">gcloud.datastore.query.Query.fetch()</span></code></a> method.</p>
<p>Under the hood, the <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.query.Query</span></code></a> class
uses this method to fetch data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_connection</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">()</span><span class="o">.</span><span class="n">kind</span><span class="p">(</span><span class="s">&#39;MyKind&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s">&#39;property =&#39;</span><span class="p">,</span> <span class="s">&#39;val&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the <cite>fetch`</cite> method...</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="go">[&lt;list of Entity Protobufs&gt;], cursor, more_results, skipped_results</span>
</pre></div>
</div>
<p>Under the hood this is doing...</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span><span class="o">.</span><span class="n">run_query</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">to_protobuf</span><span class="p">())</span>
<span class="go">[&lt;list of Entity Protobufs&gt;]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset_id</strong> (<em>string</em>) &#8211; The ID of the dataset over which to run the query.</li>
<li><strong>query_pb</strong> (<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Query</span></code>) &#8211; The Protobuf representing the query to run.</li>
<li><strong>namespace</strong> (<em>string</em>) &#8211; The namespace over which to run the query.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.save_entity">
<code class="descname">save_entity</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>key_pb</em>, <em>properties</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.save_entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.save_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an entity to the Cloud Datastore with the provided properties.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset_id</strong> (<em>string</em>) &#8211; The dataset in which to save the entity.</li>
<li><strong>key_pb</strong> (<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Key</span></code>) &#8211; The complete or partial key for the entity.</li>
<li><strong>properties</strong> (<em>dict</em>) &#8211; The properties to store on the entity.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.connection.Connection.transaction">
<code class="descname">transaction</code><span class="sig-paren">(</span><em>transaction=&lt;object object at 0x7fab970622a0&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/connection.html#Connection.transaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.connection.Connection.transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter/setter for the connection&#8217;s transaction object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transaction</strong> (<a class="reference internal" href="#gcloud.datastore.transaction.Transaction" title="gcloud.datastore.transaction.Transaction"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.transaction.Transaction</span></code></a>,
(setting), or omitted (getting).) &#8211; The new transaction (if passed).</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.transaction.Transaction" title="gcloud.datastore.transaction.Transaction"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.transaction.Transaction</span></code></a>, (getting)
or :class:<a href="#id1"><span class="problematic" id="id2">`</span></a>gcloud.datastore.connection.Connection&#8217; (setting)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the current transaction (getting) or self (setting).</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gcloud.datastore.dataset">
<span id="datasets"></span><h2>Datasets<a class="headerlink" href="#module-gcloud.datastore.dataset" title="Permalink to this headline">¶</a></h2>
<p>Create / interact with gcloud datastore datasets.</p>
<dl class="class">
<dt id="gcloud.datastore.dataset.Dataset">
<em class="property">class </em><code class="descclassname">gcloud.datastore.dataset.</code><code class="descname">Dataset</code><span class="sig-paren">(</span><em>id</em>, <em>connection=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/dataset.html#Dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.dataset.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A dataset in the Cloud Datastore.</p>
<p>This class acts as an abstraction of a single dataset
in the Cloud Datastore.</p>
<p>A dataset is analogous to a database
in relational database world,
and corresponds to a single project
using the Cloud Datastore.</p>
<p>Typically, you would only have one of these per connection
however it didn&#8217;t seem right to collapse the functionality
of a connection and a dataset together into a single class.</p>
<p>Datasets (like <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.query.Query</span></code></a>)
are immutable.
That is, you cannot change the ID and connection
references.
If you need to modify the connection or ID,
it&#8217;s recommended to construct a new <a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">Dataset</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>id</strong> (<em>string</em>) &#8211; The ID of the dataset (your project ID)</li>
<li><strong>connection</strong> (<a class="reference internal" href="#gcloud.datastore.connection.Connection" title="gcloud.datastore.connection.Connection"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.connection.Connection</span></code></a>) &#8211; The connection to use for executing API calls.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="gcloud.datastore.dataset.Dataset.connection">
<code class="descname">connection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/dataset.html#Dataset.connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.dataset.Dataset.connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current connection.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">connection</span><span class="o">=</span><span class="n">conn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">connection</span><span class="p">()</span>
<span class="go">&lt;Connection object&gt;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.connection.Connection" title="gcloud.datastore.connection.Connection"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.connection.Connection</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Returns the current connection.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.dataset.Dataset.entity">
<code class="descname">entity</code><span class="sig-paren">(</span><em>kind</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/dataset.html#Dataset.entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.dataset.Dataset.entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an entity bound to this dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kind</strong> (<em>string</em>) &#8211; the &#8220;kind&#8221; of the new entity.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.entity.Entity</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a new Entity instance, bound to this dataset.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.dataset.Dataset.get_entities">
<code class="descname">get_entities</code><span class="sig-paren">(</span><em>keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/dataset.html#Dataset.get_entities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.dataset.Dataset.get_entities" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves entities from the dataset, along with their attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>item_name</strong> &#8211; The name of the item to retrieve.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list of <a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.entity.Entity</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The requested entities.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.dataset.Dataset.get_entity">
<code class="descname">get_entity</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/dataset.html#Dataset.get_entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.dataset.Dataset.get_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves entity from the dataset, along with its attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>item_name</strong> &#8211; The name of the item to retrieve.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.entity.Entity</span></code></a> or <code class="docutils literal"><span class="pre">None</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The requested entity, or <code class="docutils literal"><span class="pre">None</span></code> if there was no match found.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.dataset.Dataset.id">
<code class="descname">id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/dataset.html#Dataset.id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.dataset.Dataset.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current dataset ID.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">connection</span><span class="o">=</span><span class="n">conn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">id</span><span class="p">()</span>
<span class="go">&#39;dataset-id&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The current dataset ID.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.dataset.Dataset.query">
<code class="descname">query</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/dataset.html#Dataset.query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.dataset.Dataset.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a query bound to this dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> &#8211; positional arguments, passed through to the Query</li>
<li><strong>kw</strong> &#8211; keyword arguments, passed through to the Query</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.query.Query</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a new Query instance, bound to this dataset.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.dataset.Dataset.transaction">
<code class="descname">transaction</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/dataset.html#Dataset.transaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.dataset.Dataset.transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a transaction bound to this dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> &#8211; positional arguments, passed through to the Transaction</li>
<li><strong>kw</strong> &#8211; keyword arguments, passed through to the Transaction</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#gcloud.datastore.transaction.Transaction" title="gcloud.datastore.transaction.Transaction"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.transaction.Transaction</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a new Transaction instance, bound to this dataset.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gcloud.datastore.entity">
<span id="entities"></span><h2>Entities<a class="headerlink" href="#module-gcloud.datastore.entity" title="Permalink to this headline">¶</a></h2>
<p>Class for representing a single entity in the Cloud Datastore.</p>
<p>Entities are akin to rows in a relational database,
storing the actual instance of data.</p>
<p>Each entity is officially represented with
a <a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a> class,
however it is possible that you might create
an Entity with only a partial Key
(that is, a Key with a Kind,
and possibly a parent, but without an ID).</p>
<p>Entities in this API act like dictionaries
with extras built in that allow you to
delete or persist the data stored on the entity.</p>
<dl class="class">
<dt id="gcloud.datastore.entity.Entity">
<em class="property">class </em><code class="descclassname">gcloud.datastore.entity.</code><code class="descname">Entity</code><span class="sig-paren">(</span><em>dataset=None</em>, <em>kind=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/entity.html#Entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.entity.Entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dict</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset</strong> (<a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>) &#8211; The dataset in which this entity belongs.</li>
<li><strong>kind</strong> (<em>string</em>) &#8211; The kind of entity this is, akin to a table name in a
relational database.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Entities are mutable and act like a subclass of a dictionary.
This means you could take an existing entity and change the key
to duplicate the object.</p>
<p>This can be used on its own, however it is likely easier to use
the shortcut methods provided by <a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>
such as:</p>
<ul>
<li><p class="first"><a class="reference internal" href="#gcloud.datastore.dataset.Dataset.entity" title="gcloud.datastore.dataset.Dataset.entity"><code class="xref py py-func docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset.entity()</span></code></a> to create a new entity.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;MyEntityKind&#39;</span><span class="p">)</span>
<span class="go">&lt;Entity[{&#39;kind&#39;: &#39;MyEntityKind&#39;}] {}&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first"><a class="reference internal" href="#gcloud.datastore.dataset.Dataset.get_entity" title="gcloud.datastore.dataset.Dataset.get_entity"><code class="xref py py-func docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset.get_entity()</span></code></a>
to retrieve an existing entity.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">&lt;Entity[{&#39;kind&#39;: &#39;EntityKind&#39;, id: 1234}] {&#39;property&#39;: &#39;value&#39;}&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p>You can the set values on the entity
just like you would on any other dictionary.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">entity</span><span class="p">[</span><span class="s">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entity</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;JJ&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entity</span>
<span class="go">&lt;Entity[{&#39;kind&#39;: &#39;EntityKind&#39;, id: 1234}] {&#39;age&#39;: 20, &#39;name&#39;: &#39;JJ&#39;}&gt;</span>
</pre></div>
</div>
<p>And you can cast an entity to a regular Python dictionary
with the <cite>dict</cite> builtin:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">dict</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
<span class="go">{&#39;age&#39;: 20, &#39;name&#39;: &#39;JJ&#39;}</span>
</pre></div>
</div>
<dl class="method">
<dt id="gcloud.datastore.entity.Entity.dataset">
<code class="descname">dataset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/entity.html#Entity.dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.entity.Entity.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">dataset.Dataset</span></code></a> in which this entity belongs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The Dataset containing the entity if there is a key,
else None.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is based on the <a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a> set on the
entity. That means that if you have no key set, the dataset might
be <cite>None</cite>. It also means that if you change the key on the entity,
this will refer to that key&#8217;s dataset.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.entity.Entity.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/entity.html#Entity.delete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.entity.Entity.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete the entity in the Cloud Datastore.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is based entirely off of the <a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a>
set on the entity. Whatever is stored remotely using the key on the
entity will be deleted.</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="gcloud.datastore.entity.Entity.from_key">
<em class="property">classmethod </em><code class="descname">from_key</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/entity.html#Entity.from_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.entity.Entity.from_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Create entity based on <a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">datastore.key.Key</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a factory method.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a>) &#8211; The key for the entity.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The <a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">Entity</span></code></a> derived from the
<a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="gcloud.datastore.entity.Entity.from_protobuf">
<em class="property">classmethod </em><code class="descname">from_protobuf</code><span class="sig-paren">(</span><em>pb</em>, <em>dataset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/entity.html#Entity.from_protobuf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.entity.Entity.from_protobuf" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method for creating an entity based on a protobuf.</p>
<p>The protobuf should be one returned from the Cloud Datastore
Protobuf API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pb</strong> (<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Entity</span></code>) &#8211; The Protobuf representing the entity.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The <a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">Entity</span></code></a> derived from the
<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Entity</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.entity.Entity.key">
<code class="descname">key</code><span class="sig-paren">(</span><em>key=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/entity.html#Entity.key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.entity.Entity.key" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the <a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">datastore.key.Key</span></code></a> on the current entity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<code class="xref py py-class docutils literal"><span class="pre">glcouddatastore.key.Key</span></code>) &#8211; The key you want to set on the entity.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Either the current key or the <a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">Entity</span></code></a>.</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">entity</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="n">my_other_key</span><span class="p">)</span>  <span class="c"># This returns the original entity.</span>
<span class="go">&lt;Entity[{&#39;kind&#39;: &#39;OtherKeyKind&#39;, &#39;id&#39;: 1234}] {&#39;property&#39;: &#39;value&#39;}&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entity</span><span class="o">.</span><span class="n">key</span><span class="p">()</span>  <span class="c"># This returns the key.</span>
<span class="go">&lt;Key[{&#39;kind&#39;: &#39;OtherKeyKind&#39;, &#39;id&#39;: 1234}]&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.entity.Entity.kind">
<code class="descname">kind</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/entity.html#Entity.kind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.entity.Entity.kind" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the kind of the current entity.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This relies entirely on
the <a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a>
set on the entity.
That means that we&#8217;re not storing the kind of the entity at all,
just the properties and a pointer to a Key
which knows its Kind.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.entity.Entity.reload">
<code class="descname">reload</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/entity.html#Entity.reload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.entity.Entity.reload" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads the contents of this entity from the datastore.</p>
<p>This method takes the <a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a>, loads all
properties from the Cloud Datastore, and sets the updated properties on
the current object.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This will override any existing properties if a different value
exists remotely, however it will <em>not</em> override any properties that
exist only locally.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.entity.Entity.save">
<code class="descname">save</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/entity.html#Entity.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.entity.Entity.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the entity in the Cloud Datastore.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.entity.Entity</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The entity with a possibly updated Key.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gcloud.datastore.key">
<span id="keys"></span><h2>Keys<a class="headerlink" href="#module-gcloud.datastore.key" title="Permalink to this headline">¶</a></h2>
<p>Create / interact with gcloud datastore keys.</p>
<dl class="class">
<dt id="gcloud.datastore.key.Key">
<em class="property">class </em><code class="descclassname">gcloud.datastore.key.</code><code class="descname">Key</code><span class="sig-paren">(</span><em>dataset=None</em>, <em>namespace=None</em>, <em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>An immutable representation of a datastore Key.</p>
<dl class="method">
<dt id="gcloud.datastore.key.Key.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dataset=None</em>, <em>namespace=None</em>, <em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor / initializer for a key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset</strong> (<a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>) &#8211; A dataset instance for the key.</li>
<li><strong>namespace</strong> (<code class="xref py py-class docutils literal"><span class="pre">str</span></code>) &#8211; A namespace identifier for the key.</li>
<li><strong>path</strong> (<em>sequence of dicts</em>) &#8211; Each dict must have keys &#8216;kind&#8217; (a string) and optionally
&#8216;name&#8217; (a string) or &#8216;id&#8217; (an integer).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Constructor / initializer for a key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset</strong> (<a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>) &#8211; A dataset instance for the key.</li>
<li><strong>namespace</strong> (<code class="xref py py-class docutils literal"><span class="pre">str</span></code>) &#8211; A namespace identifier for the key.</li>
<li><strong>path</strong> (<em>sequence of dicts</em>) &#8211; Each dict must have keys &#8216;kind&#8217; (a string) and optionally
&#8216;name&#8217; (a string) or &#8216;id&#8217; (an integer).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="gcloud.datastore.key.Key.dataset">
<code class="descname">dataset</code><span class="sig-paren">(</span><em>dataset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Dataset setter / getter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dataset</strong> (<a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>) &#8211; A dataset instance for the key.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">Key</span></code></a> (for setter); or
<a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a> (for getter)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a new key, cloned from self., with the given dataset
(setter); or self&#8217;s dataset (getter).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="gcloud.datastore.key.Key.from_path">
<em class="property">classmethod </em><code class="descname">from_path</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.from_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.from_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method for creating a key based on a path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> (<code class="xref py py-class docutils literal"><span class="pre">tuple</span></code>) &#8211; sequence of even length, where the first of each pair is a
string representing the &#8216;kind&#8217; of the path element, and
the second of the pair is either a string (for the path
element&#8217;s name) or an integer (for its id).</li>
<li><strong>kwargs</strong> (<code class="xref py py-class docutils literal"><span class="pre">dict</span></code>) &#8211; Other named parameters which can be passed to
<a class="reference internal" href="#gcloud.datastore.key.Key.__init__" title="gcloud.datastore.key.Key.__init__"><code class="xref py py-func docutils literal"><span class="pre">Key.__init__()</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a new <a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">Key</span></code></a> instance</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="gcloud.datastore.key.Key.from_protobuf">
<em class="property">classmethod </em><code class="descname">from_protobuf</code><span class="sig-paren">(</span><em>pb</em>, <em>dataset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.from_protobuf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.from_protobuf" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method for creating a key based on a protobuf.</p>
<p>The protobuf should be one returned from the Cloud Datastore
Protobuf API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pb</strong> (<code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Key</span></code>) &#8211; The Protobuf representing the key.</li>
<li><strong>dataset</strong> (<a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>) &#8211; A dataset instance.  If not passed, defaults to an
instance whose ID is derived from pb.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a new <cite>Key</cite> instance</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.key.Key.id">
<code class="descname">id</code><span class="sig-paren">(</span><em>id=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.id" title="Permalink to this definition">¶</a></dt>
<dd><p>ID setter / getter.  Based on the last element of path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kind</strong> (<code class="xref py py-class docutils literal"><span class="pre">str</span></code>) &#8211; The new kind for the key.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">Key</span></code></a> (for setter); or <code class="xref py py-class docutils literal"><span class="pre">int</span></code> (for getter)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a new key, cloned from self., with the given id (setter);
or self&#8217;s id (getter).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.key.Key.id_or_name">
<code class="descname">id_or_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.id_or_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.id_or_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter.  Based on the last element of path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">int</span></code> (if &#8216;id&#8217; is set); or <code class="xref py py-class docutils literal"><span class="pre">str</span></code> (the &#8216;name&#8217;)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if the last element of the key&#8217;s path has either an &#8216;id&#8217;
or a &#8216;name&#8217;.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.key.Key.is_partial">
<code class="descname">is_partial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.is_partial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.is_partial" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean test: is the key fully mapped onto a backend entity?</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if the last element of the key&#8217;s path does not have
an &#8216;id&#8217; or a &#8216;name&#8217;.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.key.Key.kind">
<code class="descname">kind</code><span class="sig-paren">(</span><em>kind=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.kind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.kind" title="Permalink to this definition">¶</a></dt>
<dd><p>Kind setter / getter.  Based on the last element of path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kind</strong> (<code class="xref py py-class docutils literal"><span class="pre">str</span></code>) &#8211; The new kind for the key.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">Key</span></code></a> (for setter); or <code class="xref py py-class docutils literal"><span class="pre">str</span></code> (for getter)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a new key, cloned from self., with the given kind (setter);
or self&#8217;s kind (getter).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.key.Key.name">
<code class="descname">name</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name setter / getter.  Based on the last element of path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kind</strong> (<code class="xref py py-class docutils literal"><span class="pre">str</span></code>) &#8211; The new name for the key.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">Key</span></code></a> (for setter); or <code class="xref py py-class docutils literal"><span class="pre">str</span></code> (for getter)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a new key, cloned from self., with the given name (setter);
or self&#8217;s name (getter).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.key.Key.namespace">
<code class="descname">namespace</code><span class="sig-paren">(</span><em>namespace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.namespace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.namespace" title="Permalink to this definition">¶</a></dt>
<dd><p>Namespace setter / getter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>namespace</strong> (<code class="xref py py-class docutils literal"><span class="pre">str</span></code>) &#8211; A namespace identifier for the key.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">Key</span></code></a> (for setter); or <code class="xref py py-class docutils literal"><span class="pre">str</span></code> (for getter)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a new key, cloned from self., with the given namespace
(setter); or self&#8217;s namespace (getter).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.key.Key.parent">
<code class="descname">parent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.parent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter:  return a new key for the next highest element in path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a new <cite>Key</cite> instance, whose path consists of all but the last
element of self&#8217;s path.  If self has only one path element,
return None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.key.Key.path">
<code class="descname">path</code><span class="sig-paren">(</span><em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.path" title="Permalink to this definition">¶</a></dt>
<dd><p>Path setter / getter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<em>sequence of dicts</em>) &#8211; Each dict must have keys &#8216;kind&#8217; (a string) and optionally
&#8216;name&#8217; (a string) or &#8216;id&#8217; (an integer).</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">Key</span></code></a> (for setter); or <code class="xref py py-class docutils literal"><span class="pre">str</span></code> (for getter)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a new key, cloned from self., with the given path (setter);
or self&#8217;s path (getter).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.key.Key.to_protobuf">
<code class="descname">to_protobuf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/key.html#Key.to_protobuf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.key.Key.to_protobuf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a protobuf corresponding to the key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Key</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The Protobuf representing the key.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gcloud.datastore.query">
<span id="queries"></span><h2>Queries<a class="headerlink" href="#module-gcloud.datastore.query" title="Permalink to this headline">¶</a></h2>
<p>Create / interact with gcloud datastore queries.</p>
<dl class="class">
<dt id="gcloud.datastore.query.Query">
<em class="property">class </em><code class="descclassname">gcloud.datastore.query.</code><code class="descname">Query</code><span class="sig-paren">(</span><em>kind=None</em>, <em>dataset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A Query against the Cloud Datastore.</p>
<p>This class serves as an abstraction for creating
a query over data stored in the Cloud Datastore.</p>
<p>Each <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a> object is immutable,
and a clone is returned whenever
any part of the query is modified:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="s">&#39;MyKind&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limited_query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="p">()</span> <span class="o">==</span> <span class="mi">10</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limited_query</span><span class="o">.</span><span class="n">limit</span><span class="p">()</span> <span class="o">==</span> <span class="mi">10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>You typically won&#8217;t construct a <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>
by initializing it like <code class="docutils literal"><span class="pre">Query('MyKind',</span> <span class="pre">dataset=...)</span></code>
but instead use the helper
<a class="reference internal" href="#gcloud.datastore.dataset.Dataset.query" title="gcloud.datastore.dataset.Dataset.query"><code class="xref py py-func docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset.query()</span></code></a> method
which generates a query that can be executed
without any additional work:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s">&#39;MyKind&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kind</strong> (<em>string</em>) &#8211; The kind to query.</li>
<li><strong>dataset</strong> (<a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>) &#8211; The dataset to query.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="gcloud.datastore.query.Query.OPERATORS">
<code class="descname">OPERATORS</code><em class="property"> = {'&gt;': 3, '&lt;': 1, '=': 5, '&gt;=': 4, '&lt;=': 2}</em><a class="headerlink" href="#gcloud.datastore.query.Query.OPERATORS" title="Permalink to this definition">¶</a></dt>
<dd><p>Mapping of operator strings and their protobuf equivalents.</p>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.ancestor">
<code class="descname">ancestor</code><span class="sig-paren">(</span><em>ancestor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.ancestor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.ancestor" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter the query based on an ancestor.</p>
<p>This will return a clone of the current <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>
filtered by the ancestor provided.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">parent_key</span> <span class="o">=</span> <span class="n">Key</span><span class="o">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">&#39;Person&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s">&#39;Person&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">ancestor</span><span class="p">(</span><span class="n">parent_key</span><span class="p">)</span>
</pre></div>
</div>
<p>If you don&#8217;t have a <a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a> but just
know the path, you can provide that as well:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s">&#39;Person&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">ancestor</span><span class="p">([</span><span class="s">&#39;Person&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Each call to <code class="docutils literal"><span class="pre">.ancestor()</span></code> returns a cloned <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>,
however a query may only have one ancestor at a time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ancestor</strong> (<a class="reference internal" href="#gcloud.datastore.key.Key" title="gcloud.datastore.key.Key"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.key.Key</span></code></a> or list) &#8211; Either a Key or a path of the form
<code class="docutils literal"><span class="pre">['Kind',</span> <span class="pre">'id</span> <span class="pre">or</span> <span class="pre">name',</span> <span class="pre">'Kind',</span> <span class="pre">'id</span> <span class="pre">or</span> <span class="pre">name',</span> <span class="pre">...]</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A Query filtered by the ancestor provided.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.cursor">
<code class="descname">cursor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.cursor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.cursor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns cursor ID</p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">Invoking this method on a query that has not yet been
executed will raise a RuntimeError.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">base64-encoded cursor ID string denoting the last position
consumed in the query&#8217;s result set.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.dataset">
<code class="descname">dataset</code><span class="sig-paren">(</span><em>dataset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the <a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">datastore.dataset.Dataset</span></code></a> for this Query.</p>
<p>This is the dataset against which the Query will be run.</p>
<p>This is a hybrid getter / setter, used as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="s">&#39;Person&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="n">my_dataset</span><span class="p">)</span>  <span class="c"># Set the dataset.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">dataset</span><span class="p">()</span>  <span class="c"># Get the current dataset.</span>
<span class="go">&lt;Dataset object&gt;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>, None,
or <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">If no arguments, returns the current dataset.
If a dataset is provided, returns a clone of the
<a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a> with that dataset set.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.fetch">
<code class="descname">fetch</code><span class="sig-paren">(</span><em>limit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the Query and returns all matching entities.</p>
<p>This makes an API call to the Cloud Datastore, sends the Query as a
protobuf, parses the responses to Entity protobufs, and then converts
them to <a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.entity.Entity</span></code></a> objects.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s">&#39;Person&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s">&#39;name =&#39;</span><span class="p">,</span> <span class="s">&#39;Sally&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="go">[&lt;Entity object&gt;, &lt;Entity object&gt;, ...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[&lt;Entity object&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="p">()</span>
<span class="go">None</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>limit</strong> (<em>integer</em>) &#8211; An optional limit to apply temporarily to this query.
That is, the Query itself won&#8217;t be altered,
but the limit will be applied to the query
before it is executed.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list of <a class="reference internal" href="#gcloud.datastore.entity.Entity" title="gcloud.datastore.entity.Entity"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.entity.Entity</span></code></a>&#8216;s</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The list of entities matching this query&#8217;s criteria.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>expression</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter the query based on an expression and a value.</p>
<p>This will return a clone of the current <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>
filtered by the expression and value provided.</p>
<p>Expressions take the form of:</p>
<div class="highlight-python"><div class="highlight"><pre>.filter(&#39;&lt;property&gt; &lt;operator&gt;&#39;, &lt;value&gt;)
</pre></div>
</div>
<p>where property is a property stored on the entity in the datastore
and operator is one of <code class="docutils literal"><span class="pre">OPERATORS</span></code>
(ie, <code class="docutils literal"><span class="pre">=</span></code>, <code class="docutils literal"><span class="pre">&lt;</span></code>, <code class="docutils literal"><span class="pre">&lt;=</span></code>, <code class="docutils literal"><span class="pre">&gt;</span></code>, <code class="docutils literal"><span class="pre">&gt;=</span></code>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="s">&#39;Person&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s">&#39;name =&#39;</span><span class="p">,</span> <span class="s">&#39;James&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s">&#39;age &gt;&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Because each call to <code class="docutils literal"><span class="pre">.filter()</span></code> returns a cloned <code class="docutils literal"><span class="pre">Query</span></code> object
we are able to string these together:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="s">&#39;Person&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;name =&#39;</span><span class="p">,</span> <span class="s">&#39;James&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s">&#39;age &gt;&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>expression</strong> (<em>string</em>) &#8211; An expression of a property and an
operator (ie, <code class="docutils literal"><span class="pre">=</span></code>).</li>
<li><strong>value</strong> (<em>integer, string, boolean, float, None, datetime</em>) &#8211; The value to filter on.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A Query filtered by the expression and value provided.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.kind">
<code class="descname">kind</code><span class="sig-paren">(</span><em>*kinds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.kind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.kind" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the Kind of the Query.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is an <strong>additive</strong> operation.
That is, if the Query is set for kinds A and B,
and you call <code class="docutils literal"><span class="pre">.kind('C')</span></code>,
it will query for kinds A, B, <em>and</em>, C.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kinds</strong> (<em>string</em>) &#8211; The entity kinds for which to query.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string or <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">If no arguments, returns the kind.
If a kind is provided, returns a clone of the <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>
with those kinds set.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.limit">
<code class="descname">limit</code><span class="sig-paren">(</span><em>limit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.limit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the limit of the Query.</p>
<p>This is the maximum number of rows (Entities) to return for this Query.</p>
<p>This is a hybrid getter / setter, used as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="s">&#39;Person&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>  <span class="c"># Set the limit to 100 rows.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="p">()</span>  <span class="c"># Get the limit for this query.</span>
<span class="go">100</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">integer, None, or <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">If no arguments, returns the current limit.
If a limit is provided, returns a clone of the <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>
with that limit set.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.order">
<code class="descname">order</code><span class="sig-paren">(</span><em>*properties</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.order"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a sort order to the query.</p>
<p>Sort fields will be applied in the order specified.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>properties</strong> (<em>sequence of strings</em>) &#8211; Each value is a string giving the name of the
property on which to sort, optionally preceded by a
hyphen (-) to specify descending order.
Omitting the hyphen implies ascending order.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A new Query instance, ordered as specified.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.to_protobuf">
<code class="descname">to_protobuf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.to_protobuf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.to_protobuf" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a> instance to <code class="xref py py-class docutils literal"><span class="pre">datastore_v1_pb2.Query</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Query</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A Query protobuf that can be sent to the protobuf API.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.query.Query.with_cursor">
<code class="descname">with_cursor</code><span class="sig-paren">(</span><em>start_cursor</em>, <em>end_cursor=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/query.html#Query.with_cursor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.query.Query.with_cursor" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies the starting / ending positions in a query&#8217;s result set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start_cursor</strong> (<em>bytes</em>) &#8211; Base64-encoded cursor string specifying where to
start reading query results.</li>
<li><strong>end_cursor</strong> (<em>bytes</em>) &#8211; Base64-encoded cursor string specifying where to
stop reading query results.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">If neither cursor is passed, returns self;  else, returns a
clone of the <a class="reference internal" href="#gcloud.datastore.query.Query" title="gcloud.datastore.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>, with cursors updated.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gcloud.datastore.transaction">
<span id="transactions"></span><h2>Transactions<a class="headerlink" href="#module-gcloud.datastore.transaction" title="Permalink to this headline">¶</a></h2>
<p>Create / interact with gcloud datastore transactions.</p>
<dl class="class">
<dt id="gcloud.datastore.transaction.Transaction">
<em class="property">class </em><code class="descclassname">gcloud.datastore.transaction.</code><code class="descname">Transaction</code><span class="sig-paren">(</span><em>dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/transaction.html#Transaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.transaction.Transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>An abstraction representing datastore Transactions.</p>
<p>Transactions can be used
to build up a bulk mutuation
as well as provide isolation.</p>
<p>For example,
the following snippet of code
will put the two <code class="docutils literal"><span class="pre">save</span></code> operations
(either <code class="docutils literal"><span class="pre">insert_auto_id</span></code> or <code class="docutils literal"><span class="pre">upsert</span></code>)
into the same mutation, and execute those within a transaction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transaction</span><span class="p">(</span><span class="n">bulk_mutation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># The default.</span>
<span class="gp">... </span>  <span class="n">entity1</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">... </span>  <span class="n">entity2</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>By default, the transaction is rolled back if the transaction block
exits with an error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transaction</span><span class="p">()</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
<span class="gp">... </span>  <span class="n">do_some_work</span><span class="p">()</span>
<span class="gp">... </span>  <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span> <span class="c"># rolls back</span>
</pre></div>
</div>
<p>If the transaction block exists without an exception,
it will commit by default.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Inside a transaction,
automatically assigned IDs for entities
will not be available at save time!
That means,
if you try:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
<span class="gp">... </span>  <span class="n">entity</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;Thing&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">entity</span></code> won&#8217;t have a complete Key
until the transaction is committed.</p>
<p>Once you exit the transaction (or call <code class="docutils literal"><span class="pre">commit()</span></code>),
the automatically generated ID will be assigned
to the entity:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
<span class="gp">... </span>  <span class="n">entity</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;Thing&#39;</span><span class="p">)</span>
<span class="gp">... </span>  <span class="n">entity</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">... </span>  <span class="k">assert</span> <span class="n">entity</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">.</span><span class="n">is_partial</span><span class="p">()</span>  <span class="c"># There is no ID on this key.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">entity</span><span class="o">.</span><span class="n">key</span><span class="p">()</span><span class="o">.</span><span class="n">is_partial</span><span class="p">()</span>  <span class="c"># There *is* an ID.</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>If you&#8217;re using the automatically generated ID functionality,
it&#8217;s important that you only use
<a class="reference internal" href="#gcloud.datastore.entity.Entity.save" title="gcloud.datastore.entity.Entity.save"><code class="xref py py-func docutils literal"><span class="pre">gcloud.datastore.entity.Entity.save()</span></code></a>
rather than using
<a class="reference internal" href="#gcloud.datastore.connection.Connection.save_entity" title="gcloud.datastore.connection.Connection.save_entity"><code class="xref py py-func docutils literal"><span class="pre">gcloud.datastore.connection.Connection.save_entity()</span></code></a> directly.</p>
<p class="last">If you mix the two,
the results will have extra IDs generated
and it could jumble things up.</p>
</div>
<p>If you don&#8217;t want to use the context manager
you can initialize a transaction manually:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">transaction</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transaction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transaction</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">entity</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;Thing&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entity</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">error</span><span class="p">:</span>
<span class="gp">... </span>  <span class="n">transaction</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>  <span class="n">transaction</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>For now,
this library will enforce a rule of
one transaction per connection.
That is,
If you want to work with two transactions at the same time
(for whatever reason),
that must happen over two separate
<a class="reference internal" href="#gcloud.datastore.connection.Connection" title="gcloud.datastore.connection.Connection"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.connection.Connection</span></code></a> s.</p>
<p>For example, this is perfectly valid:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
<span class="gp">... </span>  <span class="n">dataset</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;Thing&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>However, this <strong>wouldn&#8217;t</strong> be acceptable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
<span class="gp">... </span>  <span class="n">dataset</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;Thing&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">... </span>  <span class="k">with</span> <span class="n">dataset</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">dataset</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;Thing&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>Technically, it looks like the Protobuf API supports this type of pattern,
however it makes the code particularly messy.
If you really need to nest transactions, try:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gcloud</span> <span class="kn">import</span> <span class="n">datastore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset1</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset2</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s">&#39;dataset-id&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">key_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">dataset1</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
<span class="gp">... </span>  <span class="n">dataset1</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;Thing&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">... </span>  <span class="k">with</span> <span class="n">dataset2</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">dataset2</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s">&#39;Thing&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dataset</strong> (<a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a>) &#8211; The dataset to which this <a class="reference internal" href="#gcloud.datastore.transaction.Transaction" title="gcloud.datastore.transaction.Transaction"><code class="xref py py-class docutils literal"><span class="pre">Transaction</span></code></a> belongs.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="gcloud.datastore.transaction.Transaction.add_auto_id_entity">
<code class="descname">add_auto_id_entity</code><span class="sig-paren">(</span><em>entity</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/transaction.html#Transaction.add_auto_id_entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.transaction.Transaction.add_auto_id_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an entity to the list of entities to update with IDs.</p>
<p>When an entity has a partial key,
calling <code class="docutils literal"><span class="pre">save()</span></code> adds an insert_auto_id entry in the mutation.
In order to make sure we update the Entity
once the transaction is committed,
we need to keep track of which entities to update
(and the order is important).</p>
<p>When you call <code class="docutils literal"><span class="pre">save()</span></code> on an entity inside a transaction,
if the entity has a partial key,
it adds itself to the list of entities to be updated
once the transaction is committed
by calling this method.</p>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.transaction.Transaction.begin">
<code class="descname">begin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/transaction.html#Transaction.begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.transaction.Transaction.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Begins a transaction.</p>
<p>This method is called automatically when entering a with statement,
however it can be called explicitly
if you don&#8217;t want to use a context manager.</p>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.transaction.Transaction.commit">
<code class="descname">commit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/transaction.html#Transaction.commit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.transaction.Transaction.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Commits the transaction.</p>
<p>This is called automatically upon exiting a with statement,
however it can be called explicitly
if you don&#8217;t want to use a context manager.</p>
<p>This method has necessary side-effects:</p>
<ul class="simple">
<li>Sets the current connection&#8217;s transaction reference to None.</li>
<li>Sets the current transaction&#8217;s ID to None.</li>
<li>Updates paths for any keys that needed an automatically generated ID.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.transaction.Transaction.connection">
<code class="descname">connection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/transaction.html#Transaction.connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.transaction.Transaction.connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter for current connection over which the transaction will run.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.connection.Connection" title="gcloud.datastore.connection.Connection"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.connection.Connection</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The connection over which the transaction will run.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.transaction.Transaction.dataset">
<code class="descname">dataset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/transaction.html#Transaction.dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.transaction.Transaction.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter for the current dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#gcloud.datastore.dataset.Dataset" title="gcloud.datastore.dataset.Dataset"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.dataset.Dataset</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The dataset to which the transaction belongs.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.transaction.Transaction.id">
<code class="descname">id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/transaction.html#Transaction.id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.transaction.Transaction.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter for the transaction ID.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The ID of the current transaction.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.transaction.Transaction.mutation">
<code class="descname">mutation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/transaction.html#Transaction.mutation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.transaction.Transaction.mutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter for the current mutation.</p>
<p>Every transaction is committed
with a single Mutation
representing the &#8216;work&#8217; to be done as part of the transaction.
Inside a transaction,
calling <code class="docutils literal"><span class="pre">save()</span></code> on an entity
builds up the mutation.
This getter returns the Mutation protobuf
that has been built-up so far.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">gcloud.datastore.datastore_v1_pb2.Mutation</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The Mutation protobuf to be sent in the commit request.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gcloud.datastore.transaction.Transaction.rollback">
<code class="descname">rollback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gcloud/datastore/transaction.html#Transaction.rollback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gcloud.datastore.transaction.Transaction.rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>Rolls back the current transaction.</p>
<p>This method has necessary side-effects:</p>
<ul class="simple">
<li>Sets the current connection&#8217;s transaction reference to None.</li>
<li>Sets the current transaction&#8217;s ID to None.</li>
</ul>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    </div>
  </div>
    <footer id="gc-footer" class="footer" role="contentinfo">
    <div id="gc-copyright">
        &copy; Copyright 2014, JJ Geewax.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b1.
      </div>
    </footer>
  </body>
</html>